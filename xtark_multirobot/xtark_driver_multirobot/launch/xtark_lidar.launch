<?xml version="1.0"?>
<launch>
    <param name="use_sim_time" value="false"/>
    <arg name="lidar_type" value="$(optenv LIDAR_TYPE XAS)"/>

    <!-- 设置当前机器人命名空间 -->
    <arg name="namespace" default="robot0"/>
    <group ns="$(arg namespace)">
    	<group if="$(eval arg('lidar_type') == 'XAS')">
	    <node  name="rplidarNode" pkg="rplidar_ros" type="rplidarNode" output="screen">
		    <param name="serial_port"         type="string" value="/dev/lidar"/>
  		    <param name="serial_baudrate"     type="int"    value="115200"/><!--A1/A2 -->
  		    <param name="frame_id"            type="string" value="$(arg namespace)/laser"/>
  		    <param name="inverted"            type="bool"   value="false"/>
                    <param name="angle_compensate"    type="bool"   value="true"/>
                    <param name="scan_mode"    type="string"   value="Boost"/>
		    <remap from="scan" to="scan_raw"/>
	    </node>
	    <node  pkg="tf" type="static_transform_publisher" name="base_foot_print_to_laser" args="0.0 0 0.1 3.1415926 0 0 $(arg namespace)/base_footprint $(arg namespace)/laser 40"/>
    	</group>
    	<group if="$(eval arg('lidar_type') == 'XT1')">
	      <node  pkg="sc_mini" type="sc_mini" name="sc_mini" output="screen">
    		    <param name="frame_id" type="string" value="$(arg namespace)/laser"/>
    		    <param name="port" type="string" value="/dev/lidar"/>
                    <param name="baud_rate" type="int" value="115200"/>
                    <remap from="scan" to="scan_raw"/>
              </node>
              <node  pkg="tf" type="static_transform_publisher" name="base_foot_print_to_laser" args="0.1 0 0.1 -1.57 0 0 $(arg namespace)/base_footprint $(arg namespace)/laser 40"/>
      	</group>
      	<group if="$(eval arg('lidar_type') == 'YT1')">
              <node  pkg="sc_mini" type="sc_mini" name="sc_mini" output="screen">
                    <param name="frame_id" type="string" value="$(arg namespace)/laser"/>
                    <param name="port" type="string" value="/dev/lidar"/>
                    <param name="baud_rate" type="int" value="115200"/>
                    <remap from="scan" to="scan_raw"/>
              </node>
              <node  pkg="tf" type="static_transform_publisher" name="base_foot_print_to_laser" args="0.0 0 0.1 3.1415926 0 0 $(arg namespace)/base_footprint $(arg namespace)/laser 40"/>
      	</group>
        <node  pkg="laser_filters" type="scan_to_scan_filter_chain" output="log" name="laser_filter">
        	<remap from="scan" to="scan_raw"/>
		<remap from="scan_filtered" to="scan"/>
                <rosparam ns="$(arg namespace)" command="load" subst_value="True" file="$(find xtark_driver_multirobot)/config/xtark_laserfilter.yaml"/>
   	</node>
    </group>


</launch>
